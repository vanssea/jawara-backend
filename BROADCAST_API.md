# Broadcast API Documentation

## Endpoints

Base URL: `http://localhost:3000`

### Authentication
All endpoints require Bearer token authentication.
```
Authorization: Bearer <your_token>
```

---

## 1. Get All Broadcasts

**GET** `/api/broadcast`

### Response (200 OK)
```json
{
  "status": "success",
  "message": "Broadcasts fetched successfully",
  "data": [
    {
      "id": "uuid-string",
      "judul": "Test judul",
      "pesan": "Test pesan",
      "tanggal_publikasi": "2025-11-19T10:16:00+07:00",
      "link_lampiran_gambar": "https://test_gambar.com",
      "link_lampiran_dokumen": "https://test_dokumen.com",
      "created_by": "user-uuid",
      "created_at": "2025-11-30T10:00:00Z"
    }
  ]
}
```

---

## 2. Get Broadcast by ID

**GET** `/api/broadcast/:id`

### Response (200 OK)
```json
{
  "status": "success",
  "message": "Broadcast {id} fetched successfully",
  "data": {
    "id": "uuid-string",
    "judul": "Test judul",
    "pesan": "Test pesan",
    "tanggal_publikasi": "2025-11-19T10:16:00+07:00",
    "link_lampiran_gambar": "https://test_gambar.com",
    "link_lampiran_dokumen": "https://test_dokumen.com",
    "created_by": "user-uuid",
    "created_at": "2025-11-30T10:00:00Z"
  }
}
```

---

## 3. Create Broadcast

**POST** `/api/broadcast`

### Request Body
```json
{
  "judul": "Test judul",
  "pesan": "Test pesan",
  "tanggal_publikasi": "2025-11-19T10:16:00+07:00",
  "link_lampiran_gambar": "https://test_gambar.com",
  "link_lampiran_dokumen": "https://test_dokumen.com"
}
```

**Field Validations:**
- `judul`: required, string
- `pesan`: required, string
- `tanggal_publikasi`: required, ISO 8601 date string
- `link_lampiran_gambar`: optional, string
- `link_lampiran_dokumen`: optional, string

### Response (200 OK)
```json
{
  "status": "success",
  "message": "Broadcast created successfully",
  "data": {
    "id": "uuid-string",
    "judul": "Test judul",
    "pesan": "Test pesan",
    "tanggal_publikasi": "2025-11-19T10:16:00+07:00",
    "link_lampiran_gambar": "https://test_gambar.com",
    "link_lampiran_dokumen": "https://test_dokumen.com",
    "created_by": "user-uuid",
    "created_at": "2025-11-30T10:00:00Z"
  }
}
```

---

## 4. Update Broadcast

**PATCH** `/api/broadcast/:id`

### Request Body (All fields optional)
```json
{
  "judul": "Updated judul",
  "pesan": "Updated pesan",
  "tanggal_publikasi": "2025-12-01T10:16:00+07:00",
  "link_lampiran_gambar": "https://updated_gambar.com",
  "link_lampiran_dokumen": "https://updated_dokumen.com"
}
```

### Response (200 OK)
```json
{
  "status": "success",
  "message": "Broadcasts {id} updated successfully",
  "data": {
    "id": "uuid-string",
    "judul": "Updated judul",
    "pesan": "Updated pesan",
    "tanggal_publikasi": "2025-12-01T10:16:00+07:00",
    "link_lampiran_gambar": "https://updated_gambar.com",
    "link_lampiran_dokumen": "https://updated_dokumen.com",
    "created_by": "user-uuid",
    "created_at": "2025-11-30T10:00:00Z"
  }
}
```

---

## 5. Delete Broadcast

**DELETE** `/api/broadcast/:id`

### Response (200 OK)
```json
{
  "status": "success",
  "message": "Broadcasts {id} deleted successfully",
  "data": null
}
```

---

## Error Responses

### 400 Bad Request (Validation Error)
```json
{
  "statusCode": 400,
  "message": ["judul should not be empty", "pesan should not be empty"],
  "error": "Bad Request"
}
```

### 401 Unauthorized
```json
{
  "statusCode": 401,
  "message": "Unauthorized"
}
```

### 500 Internal Server Error
```json
{
  "status": "error",
  "message": "Error message",
  "statusCode": 500
}
```

---

## Flutter Integration

### Example Usage in Flutter

```dart
// Initialize repository
final broadcastRepo = BroadcastRepository(
  baseUrl: 'http://localhost:3000',
  authProvider: authProvider,
);

// Create broadcast
final newBroadcast = Broadcast(
  id: '', // Will be generated by backend
  judul: 'Test Judul',
  isi: 'Test Pesan',
  tanggal: DateTime.now(),
  linkLampiranGambar: 'https://example.com/image.jpg',
  linkLampiranDokumen: 'https://example.com/doc.pdf',
);

try {
  final created = await broadcastRepo.createBroadcast(newBroadcast);
  print('Created: ${created.id}');
} catch (e) {
  print('Error: $e');
}

// Get all broadcasts
final broadcasts = await broadcastRepo.getBroadcasts();

// Get single broadcast
final broadcast = await broadcastRepo.getBroadcast('uuid-string');

// Update broadcast
final updated = broadcast.copyWith(judul: 'Updated Title');
await broadcastRepo.updateBroadcast(updated);

// Delete broadcast
await broadcastRepo.deleteBroadcast('uuid-string');
```

---

## Notes

1. Backend menggunakan UUID (string) untuk ID, bukan integer
2. Field `pesan` di backend menjadi `isi` di Flutter model
3. Semua request harus menyertakan Bearer token di header
4. Tanggal harus dalam format ISO 8601
5. Link lampiran bersifat optional
6. Setiap create, update, delete akan mencatat log aktivitas
